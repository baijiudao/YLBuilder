<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Login</title>
	<style type="text/css">
		    body{
			    background-color:rgb(177, 208,224); font: normal 12px Trebuchet MS; color:#000;
		    }
		    .roundedCorners{ 
			    width:220px; padding:10px;
			    background-color:#DDEEF6; 
			    box-shadow: 0px 0px 10px 0px #888888;
			    border:1px solid #DDEEF6;
			    border-radius:6px;
			    position:fixed;
				top:50%;
				left:50%;
				margin:-80px 0 0 -122px;
		    }
		    .roundedCorners-textbox{ 
				border:1px solid #999; width:160px;
		    }
			.checkbox {
				margin-left: 30px;
				border:1px solid #999; width:20px;
			}
	</style>
</head>
<script type="text/javascript" src="cookie.js" ></script>
<script>
//	resizeTo(300,500)
	function dengluf(){//登录验证函数
	    var permiss;
		var name = document.getElementById("UserName").value;
		var password = document.getElementById("UserPassword").value;
				if(name !=null && password !=null && name !="" && password !=""){
			CXComm1.Init();
			if(CXComm1.Login(name,password)==0){//登录失败
				window.alert("请输入正确的用户名和密码！");
				CXComm1.Exit();
				return;
			}
			permiss = CXComm1.GetPermission()
			if(permiss>0){ //允许操作
			//将name，password 写入cookie  注销时将name，password清空
			CXComm1.Exit();
			addCookie("userName",name,5);
			addCookie("pass",password,5);
			alert("登录成功！");
			window.open("","_self");
			window.close();
			
			}
		} 
	}
	//注销
    function window_onload()
     {
       var userName = getCookie("userName");
       var pass = getCookie("pass");
       if (userName !=null && pass !=null && userName !="" && pass !="")
           {
              userName = "";
			  pass = "";
              addCookie("userName",userName,5);
			  addCookie("pass",pass,5);
              alert("您已经注销登录");
			  window.open("","_self");
			  window.close();
			  return;
           }
      }
    function check()  
  {   
    if(event.clientY<0||event.altKey)
  {   
 	CXComm1.Exit();
  }
  }  
//	removeCookie(name)
</script>
<body   onload="return window_onload()" onbeforeunload="check()">
	<OBJECT id=CXComm1 style="Z-INDEX: 105; LEFT: 336px; POSITION: absolute; TOP: 41px" codeBase=bmsocx/Messager.dll classid=clsid:8D6BC3D0-2CCF-11D5-BF01-000021D729BF>
		<PARAM NAME="TestStatus" VALUE="0"><PARAM NAME="RdbsHostName" VALUE="localhost">
	</OBJECT>
	<form method="get" id="form">	
		<div class="roundedCorners">
			<label>账号</label>&nbsp;
			<input id="UserName" type="text" class="roundedCorners-textbox" autocomplete="off" placeholder="请输入用户名..."/><br /><br />
			<label>密码</label>&nbsp;
			<input id="UserPassword" type="password" class="roundedCorners-textbox" autocomplete="off" placeholder="请输入密码..."/>
		    	<br/><br/>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<button id="submitbtn" onclick="dengluf()">确定</button>
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<input type="reset" value="清空" />
		</div>
	</form>	
	<a></a>
</body>
</html>
